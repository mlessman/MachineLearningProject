---
title: "MachineLearningProject"
author: "Matthew Lessman"
date: "Saturday, November 22, 2014"
output: pdf_document
---

----------------------------------------------------

# Report Overview

Goal:  predict the manner in which they did the exercise

Data Source:  http://groupware.les.inf.puc-rio.br/har

You should create a report describing: 

* how you built your model, 
* how you used cross validation, 
* what you think the expected out of sample error is, 
* why you made the choices you did. 
* You will also use your prediction model to predict 20 different test cases

From the paper:

Six young health participants were asked to perform one set of 10 repetitions of the Unilateral Dumbbell Biceps Curl in five different fashions: 

* exactly according to the specification (Class A), 
* throwing the elbows to the front (Class B), 
* lifting the dumbbell only halfway (Class C), 
* lowering the dumbbell only halfway (Class D)
* throwing the hips to the front (Class E).

Read more: http://groupware.les.inf.puc-rio.br/har#ixzz3JozJ2800

# Read the Data into rawTraining and finalTesting
```{r, cache=TRUE, message=FALSE, warning=FALSE}
rawTraining <- read.csv("pml-training.csv")
finalTesting <- read.csv("pml-testing.csv")
```

# Load Packages
```{r, message=FALSE, warning=FALSE}
library(caret)
library(ggplot2)
library(randomForest)
```

# Splitting the Data into Training and Testing Datasets
```{r, cache=TRUE, message=FALSE, warning=FALSE}
inTrain <- createDataPartition(y = rawTraining$classe, p = 0.75, list = FALSE)
training <- rawTraining[inTrain,]
testing <- rawTraining[-inTrain,]
dim(training)
dim(testing)
```

# Reduce the Size of the Datasets
```{r, cache=TRUE, message=FALSE, warning=FALSE}
training <- training[, c(7:11,37:49, 60:68, 84:86, 102, 113:124, 140, 151:160)]
testing <- testing[, c(7:11,37:49, 60:68, 84:86, 102, 113:124, 140, 151:160)]
```

# Check the Size of the Dataset:
```{r}
dim(training)
dim(testing)
```

# Summary Information and Exploratory Analysis
```{r}
str(training)
```

# Building the Model

Enable parellel processing:
```{r, message=FALSE, warning=FALSE}
library(doSNOW)
cluster <- makeCluster(2)
registerDoSNOW(cluster)
```

Set the trControl parameter of the train function:
```{r}
fitControl <- trainControl(method = "cv", allowParallel = TRUE, number = 2, repeats = 1)
```

Using random forest:
```{r, cache=TRUE}
modelFit <- train(training$classe ~ ., data = training, method = "rf", preProcess = "pca", trControl = fitControl, prox = TRUE)
```

ConfustionMatrix:
```{r}
confusionMatrix(testing$classe, predict(modelFit, testing))
```

Disable parellel processing:
```{r}
stopCluster(cluster)
```

# Predict the 20 from the Final Testing Set
```{r}
finalTesting <- finalTesting[, c(7:11,37:49, 60:68, 84:86, 102, 113:124, 140, 151:160)]
finalPred <- predict(modelFit, finalTesting)
finalPred
```
